«IMPORT test»
«IMPORT component»

«EXTENSION net::sourceforge::xmlfit::reader::DynamicReader»
«EXTENSION net::sourceforge::xmlfit::property::Helper»
«EXTENSION net::sourceforge::xmlfit::data::Helper»
«EXTENSION org::openarchitectureware::util::stdlib::counter»
«EXTENSION org::openarchitectureware::util::stdlib::globalvar»

«REM»
	Root template for test.
«ENDREM»
«DEFINE Root FOR test::Tests»
 «EXPAND test FOREACH test»
«ENDDEFINE»

«REM»
	Template for a test.
«ENDREM»
«DEFINE test FOR Test»
 «FILE id+"-"+name+".html"»
    «LET counterReset("COMMENT_ID") AS x»«ENDLET»
	«LET storeGlobalVar("TESTNAME_ID", name + " " +id) AS x»«ENDLET»
   <html>
    «PROTECT CSTART '<!--' CEND '-->' ID 
  		"HEAD-"+getGlobalVar("TESTNAME_ID") + "-" + counterInc("COMMENT_ID")»
     <head>
      <title>«id+"--"+name»</title>
   </head>
   «ENDPROTECT»
   <body>
   «EXPAND testStep FOREACH testStep»		
   </body>
   </html>	
 «ENDFILE»
«ENDDEFINE»

«DEFINE testStep FOR Step»
	«clearProperties()»
	«EXPAND property FOREACH property»	
	«IF data != null»
		«FOREACH createDataSource(data) AS dataSet»
			«addPropertiesFromDataSet(dataSet)»
			«EXPAND net::sourceforge::xmlfit::transform::component::Root FOR loadModelFromXmlFile(file)»
		«ENDFOREACH»
	«ELSE»
		«EXPAND net::sourceforge::xmlfit::transform::component::Root FOR loadModelFromXmlFile(file)»
	«ENDIF»
«ENDDEFINE»

«DEFINE property FOR Property»
	«addProperty(name, value)»
«ENDDEFINE»